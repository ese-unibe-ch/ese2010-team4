#{extends 'profileMain.html' /}
#{set title:'User Profile' /}
#{script 'userprofile.js' /}

#{secure.check 'user'}
<div class="form" id="userForm">
#{form @Users.changeProfile()}
	<label for="author">&{'username'}: </label>
	<div class="userInfo">
		<input type="text" username="author" id="user-inp" value="${user.username}" readonly/>
    </div>

	<label for="author">&{'email'}: </label>
	<div class="userInfo">
		<input type="text" fullname="author" id="user-inp" value="${user.email}" readonly/>
	</div>
	
	<label for="author">&{'fullname'}: </label>
	<div class="userInfo">
		#{field 'fullname'}
			<input type="text" name="${field.name}" email="author" id="user-inp" value="${user.fullname}" />
			<label for="content"></label>
		#{/field}
	</div>
   
    <label for="author">&{'birthday'}: </label>
	<div class="userInfo">
		#{field 'birthday'}
			<input type="text" name="${field.name}" email="author" id="user-inp" value="${user.getBirthday()}" />
			<label for="content"></label>
		#{/field}
	</div>
	
	<label for="author">&{'age'}: </label>
	<div class="userInfo">
		<input type="text" fullname="author" id="user-inp" value="${user.calculateAge()}" readonly/>
	</div>
	
	<label for="author">&{'website'}: </label>
	<div class="userInfo">
		#{field 'website'}
			<input type="text" name="${field.name}" email="author" id="user-inp" value="${user.website}" />
			<label for="content"></label>
		#{/field}
	</div>

	<label for="author">&{'work'}: </label>
	<div class="userInfo">
		#{field 'work'}
			<input type="text" name="${field.name}" email="author" id="user-inp" value="${user.work}" />
			<label for="content"></label>
		#{/field}
	</div>
	
	<label for="author">&{'programmingLanguages'}: </label>
	<div class="userInfo">
		#{field 'languages'}
			<input type="text" name="${field.name}" email="author" id="user-inp" value="${user.favoriteLanguages}" />
			<label for="content"></label>
		#{/field}
	</div>
	
	<label for="aboutMe">&{'about'}: </label>
	<div class="userInfo">
		#{field 'aboutMe'}
			<br>
			<textarea name="${field.name}">${user.aboutMe}</textarea>
		#{/field}
	</div>

	<div>
		<input type="submit" value="Update"/>
	</div>
	
</div>
#{/form}

<hr>

<div id="userProfile">
	<label> Upload an Avatar:
	<form action="@{Users.uploadAvatar()}" method="POST" enctype="multipart/form-data">
		<table style="padding-left: 60px">
		<input type="file" id="avatar" name="avatar" />
		<input type="submit" value="Upload" />
		</table>
	</form> 

	<br></br>
	
	#{form @Users.updateAvatarPath()}
		#{field 'URL'}
			<label for="author">or enter an URL:
			<input type="text" name="${field.name}" email="author" id="user-inp"/>
			<label for="content">
			<input type="submit" value="Submit" />
		#{/field}
	#{/form}
</div>

#{/ secure.check}

<hr>


<div id="userProfile">

	<h3>&{'activities'}</h3>
	#{list items:activities, as:'activity'}
			<div class="activity">
		
		#{activity activity:activity /}
			</div>
     #{/list}
    

	<h3>&{'repGraph'}</h3>

	<h3>Reputation Graph</h3>
	
	<script type="text/javascript">
		var userid = ${user.id};
		var graphData = #{jsAction @Users.getGraphData(':id') /};
	</script>


	<div id="graph">
		<div id="graphcanvas" style="width:600px;height:300px"></div>
	</div>


#{if flash.success}
<br>
	<p class="success">${flash.success}</p>
#{/if}

